<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EscoMind</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
<style>
  @font-face {
    font-family: 'OpenDyslexic';
    src: url('https://cdnjs.cloudflare.com/ajax/libs/opendyslexic/0.91.12/OpenDyslexic-Regular.otf') format('opentype');
  }

  :root {
    --sand: #F5ECD7;
    --sand-dark: #EDD9B5;
    --cream: #FAF4E8;
    --terracotta: #C1614F;
    --terracotta-light: #D4826F;
    --terracotta-dark: #A04F3E;
    --sage: #7A9E7E;
    --sage-light: #A3C4A8;
    --sage-dark: #5A7E5E;
    --warm-brown: #4A3728;
    --warm-brown-light: #6B5445;
    --amber: #E8A838;
    --amber-light: #F2C46A;
    --dusty-rose: #C4897A;
    --font-body: 'OpenDyslexic', 'Nunito', sans-serif;
    --font-display: 'Nunito', sans-serif;
    --radius: 18px;
    --radius-sm: 10px;
    --shadow: 0 4px 20px rgba(74,55,40,0.12);
    --shadow-lg: 0 8px 40px rgba(74,55,40,0.18);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: var(--font-body);
    background: var(--sand);
    color: var(--warm-brown);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
  .screen { display: none; min-height: 100vh; }
  .screen.active { display: flex; flex-direction: column; }

  /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
  .bottom-nav {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: var(--cream);
    border-top: 2px solid var(--sand-dark);
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 10px 0 16px;
    z-index: 100;
    box-shadow: 0 -4px 20px rgba(74,55,40,0.08);
  }
  .nav-item {
    display: flex; flex-direction: column; align-items: center; gap: 4px;
    cursor: pointer; padding: 6px 16px; border-radius: var(--radius-sm);
    transition: all 0.2s; border: none; background: none; color: var(--warm-brown-light);
    font-family: var(--font-body); font-size: 11px;
  }
  .nav-item.active { color: var(--terracotta); }
  .nav-item .nav-icon { font-size: 22px; }
  .nav-item span { font-weight: 700; }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  .app-header {
    background: var(--cream);
    padding: 52px 20px 16px;
    border-bottom: 2px solid var(--sand-dark);
    display: flex; align-items: center; justify-content: space-between;
  }
  .app-logo { font-family: var(--font-display); font-size: 28px; font-weight: 900; color: var(--terracotta); letter-spacing: -1px; }
  .app-logo span { color: var(--sage); }

  /* ‚îÄ‚îÄ SCROLL CONTENT ‚îÄ‚îÄ */
  .scroll-content { flex: 1; overflow-y: auto; padding: 20px 20px 100px; }

  /* ‚îÄ‚îÄ HOME ‚îÄ‚îÄ */
  .home-hero {
    background: linear-gradient(135deg, var(--terracotta) 0%, var(--dusty-rose) 100%);
    border-radius: var(--radius); padding: 28px 24px; margin-bottom: 24px;
    color: white; position: relative; overflow: hidden;
  }
  .home-hero::before {
    content: 'üé≠'; font-size: 80px; position: absolute; right: -10px; top: -10px; opacity: 0.2;
  }
  .home-hero h2 { font-size: 22px; font-weight: 900; margin-bottom: 6px; }
  .home-hero p { font-size: 14px; opacity: 0.9; line-height: 1.5; }
  .hero-stats { display: flex; gap: 16px; margin-top: 16px; }
  .hero-stat { background: rgba(255,255,255,0.2); border-radius: var(--radius-sm); padding: 10px 16px; text-align: center; }
  .hero-stat .num { font-size: 22px; font-weight: 900; }
  .hero-stat .lbl { font-size: 10px; opacity: 0.85; }

  .section-title { font-size: 18px; font-weight: 900; margin-bottom: 14px; color: var(--warm-brown); }

  .production-cards { display: flex; flex-direction: column; gap: 12px; margin-bottom: 28px; }
  .production-card {
    background: var(--cream); border-radius: var(--radius); padding: 18px 20px;
    box-shadow: var(--shadow); cursor: pointer; transition: transform 0.2s;
    display: flex; align-items: center; gap: 16px;
    border-left: 5px solid var(--terracotta);
  }
  .production-card:nth-child(2) { border-left-color: var(--sage); }
  .production-card:nth-child(3) { border-left-color: var(--amber); }
  .production-card:hover { transform: translateY(-2px); }
  .prod-icon { font-size: 32px; }
  .prod-info { flex: 1; }
  .prod-name { font-weight: 900; font-size: 16px; margin-bottom: 2px; }
  .prod-role { font-size: 12px; color: var(--warm-brown-light); }
  .prod-progress { margin-top: 8px; background: var(--sand); border-radius: 99px; height: 6px; }
  .prod-progress-fill { height: 6px; border-radius: 99px; background: var(--terracotta); }
  .prod-pct { font-size: 11px; color: var(--warm-brown-light); margin-top: 4px; }

  .quick-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 28px; }
  .quick-action {
    background: var(--cream); border-radius: var(--radius); padding: 18px 16px;
    box-shadow: var(--shadow); cursor: pointer; text-align: center;
    transition: transform 0.2s; border: none; font-family: var(--font-body);
  }
  .quick-action:hover { transform: translateY(-2px); }
  .quick-action .qa-icon { font-size: 28px; margin-bottom: 8px; }
  .quick-action .qa-label { font-size: 13px; font-weight: 800; color: var(--warm-brown); }

  /* ‚îÄ‚îÄ TIMER WIDGET ‚îÄ‚îÄ */
  .timer-widget {
    background: linear-gradient(135deg, var(--sage) 0%, var(--sage-dark) 100%);
    border-radius: var(--radius); padding: 20px 24px; margin-bottom: 28px;
    color: white; display: flex; align-items: center; justify-content: space-between;
  }
  .timer-info h3 { font-size: 16px; font-weight: 900; margin-bottom: 4px; }
  .timer-info p { font-size: 12px; opacity: 0.85; }
  .timer-display { font-size: 36px; font-weight: 900; font-family: var(--font-display); }
  .timer-btn {
    background: rgba(255,255,255,0.25); border: none; color: white;
    border-radius: 99px; padding: 8px 20px; font-family: var(--font-body);
    font-weight: 800; cursor: pointer; font-size: 13px; margin-top: 8px;
    transition: background 0.2s;
  }
  .timer-btn:hover { background: rgba(255,255,255,0.35); }

  /* ‚îÄ‚îÄ SCRIPT SCREEN ‚îÄ‚îÄ */
  .script-upload-area {
    background: var(--cream); border-radius: var(--radius); padding: 40px 24px;
    text-align: center; border: 3px dashed var(--sand-dark); margin-bottom: 20px;
    cursor: pointer; transition: all 0.2s;
  }
  .script-upload-area:hover { border-color: var(--terracotta); background: var(--sand); }
  .upload-icon { font-size: 48px; margin-bottom: 12px; }
  .upload-title { font-size: 18px; font-weight: 900; margin-bottom: 6px; }
  .upload-sub { font-size: 13px; color: var(--warm-brown-light); }

  .character-input-card {
    background: var(--cream); border-radius: var(--radius); padding: 20px;
    box-shadow: var(--shadow); margin-bottom: 20px;
  }
  .character-input-card h3 { font-size: 16px; font-weight: 900; margin-bottom: 12px; }
  .char-input {
    width: 100%; padding: 14px 16px; border-radius: var(--radius-sm);
    border: 2px solid var(--sand-dark); background: var(--sand);
    font-family: var(--font-body); font-size: 15px; color: var(--warm-brown);
    outline: none; transition: border-color 0.2s;
  }
  .char-input:focus { border-color: var(--terracotta); }

  .btn-primary {
    background: var(--terracotta); color: white; border: none;
    border-radius: var(--radius-sm); padding: 14px 24px;
    font-family: var(--font-body); font-weight: 900; font-size: 15px;
    cursor: pointer; width: 100%; transition: background 0.2s;
    margin-top: 12px;
  }
  .btn-primary:hover { background: var(--terracotta-dark); }

  /* ‚îÄ‚îÄ SCRIPT READER ‚îÄ‚îÄ */
  .reader-settings {
    background: var(--cream); border-radius: var(--radius); padding: 16px 20px;
    margin-bottom: 16px; box-shadow: var(--shadow);
    display: flex; gap: 10px; flex-wrap: wrap; align-items: center;
  }
  .setting-btn {
    background: var(--sand); border: 2px solid var(--sand-dark); border-radius: 99px;
    padding: 6px 14px; font-family: var(--font-body); font-size: 12px;
    font-weight: 700; cursor: pointer; color: var(--warm-brown); transition: all 0.2s;
  }
  .setting-btn.active { background: var(--terracotta); color: white; border-color: var(--terracotta); }

  .script-view {
    background: var(--cream); border-radius: var(--radius); padding: 24px 20px;
    box-shadow: var(--shadow); line-height: 1.9; font-size: 16px;
  }
  .script-line { margin-bottom: 16px; }
  .char-name { font-weight: 900; font-size: 13px; text-transform: uppercase; letter-spacing: 1px; color: var(--warm-brown-light); margin-bottom: 4px; }
  .my-line { background: rgba(193,97,79,0.1); border-left: 4px solid var(--terracotta); padding: 10px 14px; border-radius: 0 var(--radius-sm) var(--radius-sm) 0; }
  .other-line { padding: 4px 0; color: var(--warm-brown-light); }
  .word { cursor: pointer; border-radius: 3px; transition: background 0.15s; display: inline; }
  .word:hover { background: var(--amber-light); }

  /* ‚îÄ‚îÄ DICTIONARY POPUP ‚îÄ‚îÄ */
  .dict-popup {
    display: none; position: fixed; bottom: 90px; left: 20px; right: 20px;
    background: var(--warm-brown); color: white; border-radius: var(--radius);
    padding: 20px 24px; z-index: 200; box-shadow: var(--shadow-lg);
    animation: slideUp 0.25s ease;
  }
  .dict-popup.show { display: block; }
  @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
  .dict-word { font-size: 20px; font-weight: 900; margin-bottom: 4px; }
  .dict-pron { font-size: 13px; color: var(--amber-light); margin-bottom: 8px; }
  .dict-def { font-size: 14px; line-height: 1.6; }
  .dict-close { position: absolute; top: 12px; right: 16px; background: none; border: none; color: white; font-size: 20px; cursor: pointer; }
  .dict-speak { background: var(--terracotta); border: none; color: white; border-radius: 99px; padding: 6px 16px; font-family: var(--font-body); font-size: 12px; font-weight: 700; cursor: pointer; margin-top: 10px; }

  /* ‚îÄ‚îÄ PRACTICE ‚îÄ‚îÄ */
  .practice-modes { display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px; }
  .practice-mode-card {
    background: var(--cream); border-radius: var(--radius); padding: 18px 20px;
    box-shadow: var(--shadow); cursor: pointer; transition: transform 0.2s;
    display: flex; align-items: center; gap: 16px;
  }
  .practice-mode-card:hover { transform: translateY(-2px); }
  .pm-icon { font-size: 36px; }
  .pm-info { flex: 1; }
  .pm-name { font-weight: 900; font-size: 16px; margin-bottom: 2px; }
  .pm-desc { font-size: 12px; color: var(--warm-brown-light); line-height: 1.4; }
  .pm-arrow { font-size: 20px; color: var(--warm-brown-light); }

  /* ‚îÄ‚îÄ CUE CARD ‚îÄ‚îÄ */
  .cue-card-screen { display: none; }
  .cue-card-screen.active { display: flex; flex-direction: column; }
  .cue-header { background: var(--cream); padding: 52px 20px 16px; border-bottom: 2px solid var(--sand-dark); display: flex; align-items: center; gap: 12px; }
  .back-btn { background: none; border: none; font-size: 22px; cursor: pointer; color: var(--warm-brown); }
  .cue-title { font-size: 18px; font-weight: 900; }
  .cue-content { flex: 1; padding: 24px 20px 100px; display: flex; flex-direction: column; gap: 16px; }

  .progress-bar-wrap { background: var(--sand-dark); border-radius: 99px; height: 8px; margin-bottom: 8px; }
  .progress-bar-fill { height: 8px; border-radius: 99px; background: linear-gradient(90deg, var(--terracotta), var(--amber)); transition: width 0.4s; }
  .progress-label { font-size: 12px; color: var(--warm-brown-light); margin-bottom: 16px; }

  .cue-box {
    background: var(--cream); border-radius: var(--radius); padding: 24px;
    box-shadow: var(--shadow);
  }
  .cue-box-label { font-size: 11px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; color: var(--warm-brown-light); margin-bottom: 10px; }
  .cue-text { font-size: 17px; line-height: 1.8; color: var(--warm-brown); }

  .my-line-box {
    background: var(--cream); border-radius: var(--radius); padding: 24px;
    box-shadow: var(--shadow); border: 2px solid var(--sand-dark);
    min-height: 100px; cursor: pointer; transition: all 0.2s;
    display: flex; align-items: center; justify-content: center; text-align: center;
  }
  .my-line-box.revealed { background: rgba(122,158,126,0.1); border-color: var(--sage); }
  .my-line-placeholder { color: var(--warm-brown-light); font-size: 15px; }
  .my-line-text { font-size: 17px; line-height: 1.8; color: var(--warm-brown); }

  .feedback-row { display: flex; gap: 12px; }
  .feedback-btn {
    flex: 1; padding: 14px; border-radius: var(--radius-sm); border: none;
    font-family: var(--font-body); font-weight: 900; font-size: 14px;
    cursor: pointer; transition: all 0.2s;
  }
  .feedback-btn.wrong { background: #F5D0CA; color: var(--terracotta-dark); }
  .feedback-btn.close { background: var(--amber-light); color: #7A5500; }
  .feedback-btn.correct { background: rgba(122,158,126,0.3); color: var(--sage-dark); }

  .voice-btn {
    background: var(--terracotta); color: white; border: none;
    border-radius: var(--radius-sm); padding: 16px; font-size: 22px;
    cursor: pointer; transition: all 0.2s; display: flex; align-items: center;
    justify-content: center; gap: 10px; font-family: var(--font-body);
    font-weight: 900; font-size: 15px; width: 100%;
  }
  .voice-btn:hover { background: var(--terracotta-dark); }
  .voice-btn.listening { background: var(--sage); animation: pulse 1s infinite; }
  @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.03); } }

  /* ‚îÄ‚îÄ GAME CENTER ‚îÄ‚îÄ */
  .game-center-hero {
    background: linear-gradient(135deg, var(--warm-brown) 0%, var(--warm-brown-light) 100%);
    border-radius: var(--radius); padding: 28px 24px; margin-bottom: 24px;
    color: white; position: relative; overflow: hidden;
  }
  .game-center-hero::before { content: 'üéÆ'; font-size: 80px; position: absolute; right: -10px; top: -10px; opacity: 0.15; }
  .game-center-hero h2 { font-size: 24px; font-weight: 900; margin-bottom: 6px; }
  .game-center-hero p { font-size: 14px; opacity: 0.85; }

  .daily-challenge {
    background: linear-gradient(135deg, var(--amber) 0%, var(--terracotta) 100%);
    border-radius: var(--radius); padding: 20px 24px; margin-bottom: 24px;
    color: white; display: flex; align-items: center; justify-content: space-between;
    cursor: pointer; transition: transform 0.2s;
  }
  .daily-challenge:hover { transform: translateY(-2px); }
  .dc-info h3 { font-size: 16px; font-weight: 900; margin-bottom: 4px; }
  .dc-info p { font-size: 13px; opacity: 0.9; }
  .dc-icon { font-size: 40px; }

  .game-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 24px; }
  .game-card {
    border-radius: var(--radius); padding: 20px 16px; cursor: pointer;
    transition: transform 0.2s; box-shadow: var(--shadow); position: relative; overflow: hidden;
  }
  .game-card:hover { transform: translateY(-3px); }
  .game-card-1 { background: linear-gradient(135deg, #E8C4A0, #D4A070); }
  .game-card-2 { background: linear-gradient(135deg, var(--sage-light), var(--sage)); }
  .game-card-3 { background: linear-gradient(135deg, #D4A4B4, #B87090); }
  .game-card-4 { background: linear-gradient(135deg, #A0C4D4, #6090B0); }
  .gc-icon { font-size: 36px; margin-bottom: 10px; }
  .gc-name { font-size: 14px; font-weight: 900; color: var(--warm-brown); margin-bottom: 4px; }
  .gc-desc { font-size: 11px; color: var(--warm-brown-light); line-height: 1.4; }
  .gc-best { position: absolute; top: 10px; right: 12px; font-size: 10px; font-weight: 900; color: var(--warm-brown-light); }

  .xp-card {
    background: var(--cream); border-radius: var(--radius); padding: 20px 24px;
    box-shadow: var(--shadow); margin-bottom: 24px;
  }
  .xp-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .xp-title { font-size: 16px; font-weight: 900; }
  .xp-level { background: var(--terracotta); color: white; border-radius: 99px; padding: 4px 12px; font-size: 12px; font-weight: 900; }
  .xp-bar { background: var(--sand); border-radius: 99px; height: 10px; margin-bottom: 8px; }
  .xp-fill { height: 10px; border-radius: 99px; background: linear-gradient(90deg, var(--terracotta), var(--amber)); width: 65%; }
  .xp-sub { font-size: 12px; color: var(--warm-brown-light); }

  .badges { display: flex; gap: 10px; flex-wrap: wrap; }
  .badge { background: var(--sand); border-radius: var(--radius-sm); padding: 8px 12px; font-size: 20px; text-align: center; }
  .badge-label { font-size: 10px; color: var(--warm-brown-light); font-weight: 700; margin-top: 2px; }

  /* ‚îÄ‚îÄ GAME: FILL IN THE BLANK ‚îÄ‚îÄ */
  .game-screen {
    display: none; min-height: 100vh; flex-direction: column;
    background: var(--sand);
  }
  .game-screen.active { display: flex; }
  .game-header {
    background: var(--cream); padding: 52px 20px 16px;
    border-bottom: 2px solid var(--sand-dark);
    display: flex; align-items: center; gap: 12px;
  }
  .game-body { flex: 1; padding: 24px 20px 100px; display: flex; flex-direction: column; gap: 16px; }

  .score-strip { display: flex; justify-content: space-between; align-items: center; }
  .score-pill { background: var(--terracotta); color: white; border-radius: 99px; padding: 6px 16px; font-size: 13px; font-weight: 900; }
  .streak-pill { background: var(--amber); color: var(--warm-brown); border-radius: 99px; padding: 6px 16px; font-size: 13px; font-weight: 900; }
  .timer-pill { background: var(--sage); color: white; border-radius: 99px; padding: 6px 16px; font-size: 13px; font-weight: 900; }

  .game-card-inner {
    background: var(--cream); border-radius: var(--radius); padding: 24px;
    box-shadow: var(--shadow); line-height: 2; font-size: 18px;
  }
  .blank {
    display: inline-block; min-width: 90px; border-bottom: 3px solid var(--terracotta);
    margin: 0 4px; text-align: center; font-weight: 900; color: var(--terracotta);
    cursor: pointer; padding: 0 6px;
  }
  .blank.filled { color: var(--sage-dark); border-color: var(--sage); }
  .blank.wrong-ans { color: var(--terracotta-dark); border-color: var(--terracotta); animation: shake 0.3s; }
  @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-6px)} 75%{transform:translateX(6px)} }

  .word-options { display: flex; flex-wrap: wrap; gap: 10px; }
  .word-option {
    background: var(--sand); border: 2px solid var(--sand-dark); border-radius: 99px;
    padding: 8px 18px; font-family: var(--font-body); font-size: 14px;
    font-weight: 700; cursor: pointer; color: var(--warm-brown); transition: all 0.2s;
  }
  .word-option:hover { background: var(--terracotta); color: white; border-color: var(--terracotta); }
  .word-option.used { opacity: 0.4; pointer-events: none; }

  .result-banner {
    border-radius: var(--radius-sm); padding: 14px 20px; font-weight: 900; font-size: 15px;
    text-align: center; display: none;
  }
  .result-banner.correct-result { background: rgba(122,158,126,0.2); color: var(--sage-dark); display: block; }
  .result-banner.wrong-result { background: rgba(193,97,79,0.15); color: var(--terracotta-dark); display: block; }

  .next-btn {
    background: var(--terracotta); color: white; border: none;
    border-radius: var(--radius-sm); padding: 16px;
    font-family: var(--font-body); font-weight: 900; font-size: 16px;
    cursor: pointer; width: 100%; display: none; transition: background 0.2s;
  }
  .next-btn.show { display: block; }
  .next-btn:hover { background: var(--terracotta-dark); }

  /* ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ */
  .settings-section { background: var(--cream); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); margin-bottom: 16px; }
  .settings-section h3 { font-size: 16px; font-weight: 900; margin-bottom: 16px; color: var(--warm-brown); }
  .setting-row { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--sand); }
  .setting-row:last-child { border-bottom: none; }
  .setting-name { font-size: 14px; font-weight: 700; }
  .setting-desc { font-size: 11px; color: var(--warm-brown-light); margin-top: 2px; }
  .toggle {
    width: 48px; height: 26px; border-radius: 99px; background: var(--sand-dark);
    position: relative; cursor: pointer; transition: background 0.2s; border: none;
  }
  .toggle.on { background: var(--sage); }
  .toggle::after {
    content: ''; position: absolute; width: 20px; height: 20px; border-radius: 50%;
    background: white; top: 3px; left: 3px; transition: left 0.2s;
    box-shadow: 0 1px 4px rgba(0,0,0,0.2);
  }
  .toggle.on::after { left: 25px; }

  .font-size-control { display: flex; align-items: center; gap: 12px; }
  .fs-btn { background: var(--sand); border: 2px solid var(--sand-dark); width: 34px; height: 34px; border-radius: 99px; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-family: var(--font-body); color: var(--warm-brown); font-weight: 900; }
  .fs-val { font-size: 15px; font-weight: 900; min-width: 30px; text-align: center; }

  .color-swatches { display: flex; gap: 10px; flex-wrap: wrap; }
  .swatch {
    width: 36px; height: 36px; border-radius: 99px; cursor: pointer;
    border: 3px solid transparent; transition: border-color 0.2s;
  }
  .swatch.active { border-color: var(--warm-brown); }

  /* ‚îÄ‚îÄ TIMER MODAL ‚îÄ‚îÄ */
  .modal-overlay {
    display: none; position: fixed; inset: 0; background: rgba(74,55,40,0.5);
    z-index: 300; align-items: flex-end; justify-content: center;
  }
  .modal-overlay.show { display: flex; }
  .modal-sheet {
    background: var(--cream); border-radius: var(--radius) var(--radius) 0 0;
    padding: 28px 24px 40px; width: 100%; max-width: 600px;
    animation: slideUp 0.3s ease;
  }
  .modal-title { font-size: 22px; font-weight: 900; margin-bottom: 20px; text-align: center; }
  .timer-big { font-size: 72px; font-weight: 900; font-family: var(--font-display); text-align: center; color: var(--terracotta); margin: 20px 0; letter-spacing: -2px; }
  .timer-mode { text-align: center; font-size: 14px; color: var(--warm-brown-light); margin-bottom: 20px; font-weight: 700; }
  .timer-controls { display: flex; gap: 12px; }
  .timer-ctrl-btn {
    flex: 1; padding: 14px; border-radius: var(--radius-sm); border: none;
    font-family: var(--font-body); font-weight: 900; font-size: 15px; cursor: pointer;
  }
  .timer-ctrl-btn.start { background: var(--terracotta); color: white; }
  .timer-ctrl-btn.stop { background: var(--sand); color: var(--warm-brown); }
  .break-options { display: flex; gap: 10px; margin-bottom: 20px; }
  .break-opt {
    flex: 1; padding: 12px; border-radius: var(--radius-sm); border: 2px solid var(--sand-dark);
    background: var(--sand); font-family: var(--font-body); font-weight: 900; font-size: 14px;
    cursor: pointer; color: var(--warm-brown); text-align: center; transition: all 0.2s;
  }
  .break-opt.active { border-color: var(--sage); background: rgba(122,158,126,0.15); color: var(--sage-dark); }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (min-width: 768px) {
    body { max-width: 480px; margin: 0 auto; }
    .bottom-nav { max-width: 480px; left: 50%; transform: translateX(-50%); }
  }

  /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
  .toast {
    position: fixed; top: 60px; left: 50%; transform: translateX(-50%) translateY(-20px);
    background: var(--warm-brown); color: white; padding: 12px 24px;
    border-radius: 99px; font-weight: 900; font-size: 14px; z-index: 400;
    opacity: 0; transition: all 0.3s; pointer-events: none; white-space: nowrap;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* ‚îÄ‚îÄ STREAK ANIMATION ‚îÄ‚îÄ */
  .streak-anim {
    position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%);
    font-size: 80px; z-index: 500; pointer-events: none; opacity: 0;
    transition: all 0.4s;
  }
  .streak-anim.show { opacity: 1; transform: translate(-50%,-60%); }
</style>
</head>
<body>

<!-- TOAST -->
<div class="toast" id="toast"></div>
<div class="streak-anim" id="streakAnim">üî•</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HOME SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen active" id="homeScreen">
  <div class="app-header">
    <div class="app-logo">Esco<span>Mind</span></div>
    <button onclick="showTimer()" style="background:var(--sage);border:none;color:white;border-radius:99px;padding:8px 16px;font-family:var(--font-body);font-weight:800;font-size:13px;cursor:pointer;">‚è± Timer</button>
  </div>
  <div class="scroll-content">
    <div class="home-hero">
      <h2>Welcome back! üé≠</h2>
      <p>You're on a 5-day streak. Keep going!</p>
      <div class="hero-stats">
        <div class="hero-stat"><div class="num">5üî•</div><div class="lbl">Day Streak</div></div>
        <div class="hero-stat"><div class="num">847</div><div class="lbl">XP Total</div></div>
        <div class="hero-stat"><div class="num">73%</div><div class="lbl">Lines Learned</div></div>
      </div>
    </div>

    <div class="section-title">My Productions</div>
    <div class="production-cards">
      <div class="production-card" onclick="goToScript()">
        <div class="prod-icon">üé≠</div>
        <div class="prod-info">
          <div class="prod-name">A Midsummer Night's Dream</div>
          <div class="prod-role">Playing: Puck ‚Äî Theatre</div>
          <div class="prod-progress"><div class="prod-progress-fill" style="width:73%"></div></div>
          <div class="prod-pct">73% learned</div>
        </div>
      </div>
      <div class="production-card" onclick="goToScript()">
        <div class="prod-icon">üé¨</div>
        <div class="prod-info">
          <div class="prod-name">Episode 4 ‚Äî The Return</div>
          <div class="prod-role">Playing: Marcus ‚Äî TV Drama</div>
          <div class="prod-progress"><div class="prod-progress-fill" style="width:40%;background:var(--sage)"></div></div>
          <div class="prod-pct">40% learned</div>
        </div>
      </div>
    </div>

    <div class="section-title">Quick Actions</div>
    <div class="quick-actions">
      <button class="quick-action" onclick="goTo('practiceScreen')">
        <div class="qa-icon">üìö</div>
        <div class="qa-label">Practice Lines</div>
      </button>
      <button class="quick-action" onclick="goTo('gameScreen')">
        <div class="qa-icon">üéÆ</div>
        <div class="qa-label">Game Center</div>
      </button>
      <button class="quick-action" onclick="goToScript()">
        <div class="qa-icon">üìÑ</div>
        <div class="qa-label">Read Script</div>
      </button>
      <button class="quick-action" onclick="showTimer()">
        <div class="qa-icon">‚è±</div>
        <div class="qa-label">Study Timer</div>
      </button>
    </div>

    <div class="section-title">Today's Progress</div>
    <div class="xp-card">
      <div class="xp-header">
        <div class="xp-title">Level 8 ‚Äî Rising Star ‚≠ê</div>
        <div class="xp-level">847 XP</div>
      </div>
      <div class="xp-bar"><div class="xp-fill"></div></div>
      <div class="xp-sub">153 XP to Level 9</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCRIPT SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="scriptScreen">
  <div class="app-header">
    <div class="app-logo">Esco<span>Mind</span></div>
    <div style="font-size:14px;font-weight:800;color:var(--warm-brown-light);">Scripts</div>
  </div>
  <div class="scroll-content">
    <div class="script-upload-area" onclick="showToast('PDF upload ready! Tap to select your script üìÑ')">
      <div class="upload-icon">üìÇ</div>
      <div class="upload-title">Upload Your Script</div>
      <div class="upload-sub">PDF supported ¬∑ Text & scanned scripts</div>
    </div>

    <div class="character-input-card">
      <h3>Who are you playing?</h3>
      <input class="char-input" type="text" placeholder="Enter your character name..." value="PUCK" id="charName">
      <button class="btn-primary" onclick="loadScript()">üîç Find My Lines</button>
    </div>

    <div id="scriptReadView" style="display:none;">
      <div class="reader-settings">
        <button class="setting-btn active" onclick="toggleSetting(this)">OpenDyslexic</button>
        <button class="setting-btn" onclick="toggleSetting(this)">Larger Text</button>
        <button class="setting-btn" onclick="toggleSetting(this)">üîä Read Aloud</button>
        <button class="setting-btn" onclick="toggleSetting(this)">ü´ß Tint</button>
      </div>
      <div class="script-view" id="scriptContent"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PRACTICE SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="practiceScreen">
  <div class="app-header">
    <div class="app-logo">Esco<span>Mind</span></div>
    <div style="font-size:14px;font-weight:800;color:var(--warm-brown-light);">Practice</div>
  </div>
  <div class="scroll-content">
    <div class="section-title">Choose Your Mode</div>
    <div class="practice-modes">
      <div class="practice-mode-card" onclick="startCueCards()">
        <div class="pm-icon">üÉè</div>
        <div class="pm-info">
          <div class="pm-name">Cue Cards</div>
          <div class="pm-desc">See the cue line, recall your line. Classic line learning.</div>
        </div>
        <div class="pm-arrow">‚Ä∫</div>
      </div>
      <div class="practice-mode-card" onclick="showToast('Fade Mode ‚Äî coming in next update! üåÖ')">
        <div class="pm-icon">üåÖ</div>
        <div class="pm-info">
          <div class="pm-name">Fade Mode</div>
          <div class="pm-desc">Lines gradually disappear as you gain confidence.</div>
        </div>
        <div class="pm-arrow">‚Ä∫</div>
      </div>
      <div class="practice-mode-card" onclick="showToast('Spaced Repetition ‚Äî your hardest lines, prioritised! üß†')">
        <div class="pm-icon">üß†</div>
        <div class="pm-info">
          <div class="pm-name">Spaced Repetition</div>
          <div class="pm-desc">EscoMind focuses on the lines you find hardest.</div>
        </div>
        <div class="pm-arrow">‚Ä∫</div>
      </div>
      <div class="practice-mode-card" onclick="showToast('Full Run ‚Äî do the whole scene! üé¨')">
        <div class="pm-icon">üé¨</div>
        <div class="pm-info">
          <div class="pm-name">Full Scene Run</div>
          <div class="pm-desc">Run the whole scene from start to finish.</div>
        </div>
        <div class="pm-arrow">‚Ä∫</div>
      </div>
    </div>

    <div class="section-title">Needs Work üîÅ</div>
    <div style="background:var(--cream);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow);">
      <div style="font-size:14px;line-height:1.8;color:var(--warm-brown-light);border-left:4px solid var(--terracotta);padding-left:14px;margin-bottom:12px;font-style:italic;">"I am that merry wanderer of the night."</div>
      <div style="font-size:14px;line-height:1.8;color:var(--warm-brown-light);border-left:4px solid var(--terracotta);padding-left:14px;font-style:italic;">"Lord, what fools these mortals be!"</div>
      <button class="btn-primary" onclick="startCueCards()" style="margin-top:16px;">Practice These Lines</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CUE CARD PRACTICE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="cueScreen">
  <div class="cue-header">
    <button class="back-btn" onclick="goTo('practiceScreen')">‚Äπ</button>
    <div class="cue-title">Cue Cards ‚Äî Puck</div>
  </div>
  <div class="cue-content">
    <div class="progress-bar-wrap"><div class="progress-bar-fill" id="cueProgress" style="width:0%"></div></div>
    <div class="progress-label" id="cueProgressLabel">Line 1 of 6</div>

    <div class="cue-box">
      <div class="cue-box-label">üé§ Cue ‚Äî Fairy speaks:</div>
      <div class="cue-text" id="cueText">Loading...</div>
    </div>

    <div class="my-line-box" id="myLineBox" onclick="revealLine()">
      <div class="my-line-placeholder" id="myLinePlaceholder">Tap to reveal your line ‚Äî or use voice üéô</div>
      <div class="my-line-text" id="myLineText" style="display:none;"></div>
    </div>

    <button class="voice-btn" id="voiceBtn" onclick="toggleVoice()">
      üéô Speak Your Line
    </button>

    <div class="result-banner" id="resultBanner"></div>

    <div class="feedback-row" id="feedbackRow" style="display:none;">
      <button class="feedback-btn wrong" onclick="nextCue('wrong')">‚úó Wrong</button>
      <button class="feedback-btn close" onclick="nextCue('close')">~ Close</button>
      <button class="feedback-btn correct" onclick="nextCue('correct')">‚úì Got it!</button>
    </div>

    <button class="next-btn" id="nextBtn" onclick="nextCue('correct')">Next Line ‚Üí</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GAME CENTER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="gameScreen">
  <div class="app-header">
    <div class="app-logo">Esco<span>Mind</span></div>
    <div style="font-size:14px;font-weight:800;color:var(--warm-brown-light);">Game Center</div>
  </div>
  <div class="scroll-content">
    <div class="game-center-hero">
      <h2>Game Center üéÆ</h2>
      <p>Learn your lines through play. Pick a game and let's go!</p>
    </div>

    <div class="daily-challenge" onclick="startFillBlank()">
      <div class="dc-info">
        <h3>‚ö° Daily Challenge</h3>
        <p>Today: Fill in the Blank ¬∑ 3 scenes</p>
      </div>
      <div class="dc-icon">üèÜ</div>
    </div>

    <div class="xp-card">
      <div class="xp-header">
        <div class="xp-title">Your XP Progress</div>
        <div class="xp-level">Level 8</div>
      </div>
      <div class="xp-bar"><div class="xp-fill"></div></div>
      <div class="xp-sub">847 / 1000 XP ¬∑ 153 to Level 9</div>
      <div style="margin-top:16px;">
        <div style="font-size:13px;font-weight:900;margin-bottom:10px;">Badges Earned</div>
        <div class="badges">
          <div class="badge">üî•<div class="badge-label">5 Streak</div></div>
          <div class="badge">‚≠ê<div class="badge-label">First Win</div></div>
          <div class="badge">üé≠<div class="badge-label">Actor</div></div>
          <div class="badge">üß†<div class="badge-label">Memory</div></div>
        </div>
      </div>
    </div>

    <div class="section-title">Choose a Game</div>
    <div class="game-cards">
      <div class="game-card game-card-1" onclick="startFillBlank()">
        <div class="gc-best">Best: 420</div>
        <div class="gc-icon">üìù</div>
        <div class="gc-name">Fill in the Blank</div>
        <div class="gc-desc">Complete the missing words in your lines</div>
      </div>
      <div class="game-card game-card-2" onclick="showToast('Word Scramble ‚Äî unscramble your lines! üîÄ')">
        <div class="gc-best">Best: 380</div>
        <div class="gc-icon">üîÄ</div>
        <div class="gc-name">Word Scramble</div>
        <div class="gc-desc">Put your jumbled line back in order</div>
      </div>
      <div class="game-card game-card-3" onclick="showToast('Memory Match ‚Äî pair cues to lines! üß©')">
        <div class="gc-best">Best: 290</div>
        <div class="gc-icon">üß©</div>
        <div class="gc-name">Memory Match</div>
        <div class="gc-desc">Match the cue to the right line</div>
      </div>
      <div class="game-card game-card-4" onclick="showToast('Beat the Clock ‚Äî how fast can you go? ‚ö°')">
        <div class="gc-best">Best: 510</div>
        <div class="gc-icon">‚ö°</div>
        <div class="gc-name">Beat the Clock</div>
        <div class="gc-desc">Race against the timer for big points</div>
      </div>
    </div>

    <div style="display:flex;gap:12px;margin-bottom:20px;">
      <button class="setting-btn active" onclick="switchScripts(this,'mine')">My Scripts</button>
      <button class="setting-btn" onclick="switchScripts(this,'sample')">Sample Scripts</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê FILL IN THE BLANK GAME ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="game-screen" id="fillBlankGame">
  <div class="game-header">
    <button class="back-btn" onclick="goTo('gameScreen')">‚Äπ</button>
    <div style="flex:1;">
      <div style="font-size:18px;font-weight:900;">Fill in the Blank üìù</div>
    </div>
    <div style="display:flex;gap:8px;align-items:center;">
      <select id="diffSelect" onchange="changeDiff(this.value)" style="background:var(--sand);border:2px solid var(--sand-dark);border-radius:99px;padding:6px 12px;font-family:var(--font-body);font-weight:700;color:var(--warm-brown);font-size:12px;cursor:pointer;">
        <option value="easy">Easy</option>
        <option value="medium" selected>Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
  </div>
  <div class="game-body">
    <div class="score-strip">
      <div class="score-pill">‚≠ê <span id="gameScore">0</span> pts</div>
      <div class="streak-pill">üî• <span id="gameStreak">0</span> streak</div>
      <div class="timer-pill">‚è± <span id="gameTimer">60</span>s</div>
    </div>

    <div class="progress-bar-wrap" style="margin-top:4px;">
      <div class="progress-bar-fill" id="gameProgress" style="width:0%"></div>
    </div>

    <div class="game-card-inner" id="gameLineDisplay"></div>

    <div>
      <div style="font-size:13px;font-weight:900;color:var(--warm-brown-light);margin-bottom:10px;">Choose the missing word:</div>
      <div class="word-options" id="wordOptions"></div>
    </div>

    <div class="result-banner" id="gameResultBanner"></div>
    <button class="next-btn" id="gameNextBtn" onclick="nextGameQuestion()">Next Line ‚Üí</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="settingsScreen">
  <div class="app-header">
    <div class="app-logo">Esco<span>Mind</span></div>
    <div style="font-size:14px;font-weight:800;color:var(--warm-brown-light);">Settings</div>
  </div>
  <div class="scroll-content">

    <div class="settings-section">
      <h3>üî§ Text & Display</h3>
      <div class="setting-row">
        <div>
          <div class="setting-name">OpenDyslexic Font</div>
          <div class="setting-desc">Dyslexia-friendly font throughout the app</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
      <div class="setting-row">
        <div class="setting-name">Font Size</div>
        <div class="font-size-control">
          <button class="fs-btn" onclick="changeFontSize(-1)">‚àí</button>
          <div class="fs-val" id="fontSizeVal">16</div>
          <button class="fs-btn" onclick="changeFontSize(1)">+</button>
        </div>
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-name">Extra Line Spacing</div>
          <div class="setting-desc">More space between lines</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-name">Text-to-Speech</div>
          <div class="setting-desc">Read lines aloud automatically</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
    </div>

    <div class="settings-section">
      <h3>üé® Colour Theme</h3>
      <div class="setting-row" style="flex-direction:column;align-items:flex-start;gap:12px;">
        <div class="setting-name">Background Tint</div>
        <div class="color-swatches">
          <div class="swatch active" style="background:#F5ECD7;" onclick="setTheme('#F5ECD7',this)"></div>
          <div class="swatch" style="background:#E8F0E4;" onclick="setTheme('#E8F0E4',this)"></div>
          <div class="swatch" style="background:#F0E8F0;" onclick="setTheme('#F0E8F0',this)"></div>
          <div class="swatch" style="background:#E8EEF5;" onclick="setTheme('#E8EEF5',this)"></div>
          <div class="swatch" style="background:#F5F0E0;" onclick="setTheme('#F5F0E0',this)"></div>
          <div class="swatch" style="background:#F0EAE0;" onclick="setTheme('#F0EAE0',this)"></div>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h3>‚è± Study Timer</h3>
      <div class="setting-row">
        <div class="setting-name">Study Session Length</div>
        <div style="font-weight:900;color:var(--terracotta);">20 min</div>
      </div>
      <div class="setting-row">
        <div class="setting-name">Break Length</div>
        <div style="display:flex;gap:8px;">
          <button class="setting-btn active" onclick="setBreak(5,this)">5 min</button>
          <button class="setting-btn" onclick="setBreak(10,this)">10 min</button>
        </div>
      </div>
    </div>

    <div class="settings-section">
      <h3>üéô Line Checking</h3>
      <div class="setting-row">
        <div>
          <div class="setting-name">Word-Perfect Mode</div>
          <div class="setting-desc">Every word must match exactly</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-name">Voice Input</div>
          <div class="setting-desc">Speak your lines for checking</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
    </div>

    <div class="settings-section">
      <h3>üîî Notifications</h3>
      <div class="setting-row">
        <div>
          <div class="setting-name">Daily Reminder</div>
          <div class="setting-desc">Remind me to practice each day</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
      <div class="setting-row">
        <div>
          <div class="setting-name">Streak Alerts</div>
          <div class="setting-desc">Don't let me break my streak!</div>
        </div>
        <button class="toggle on" onclick="this.classList.toggle('on')"></button>
      </div>
    </div>

  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BOTTOM NAV ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav class="bottom-nav">
  <button class="nav-item active" onclick="navTo('homeScreen',this)">
    <div class="nav-icon">üè†</div><span>Home</span>
  </button>
  <button class="nav-item" onclick="navTo('scriptScreen',this)">
    <div class="nav-icon">üìÑ</div><span>Scripts</span>
  </button>
  <button class="nav-item" onclick="navTo('practiceScreen',this)">
    <div class="nav-icon">üìö</div><span>Practice</span>
  </button>
  <button class="nav-item" onclick="navTo('gameScreen',this)">
    <div class="nav-icon">üéÆ</div><span>Games</span>
  </button>
  <button class="nav-item" onclick="navTo('settingsScreen',this)">
    <div class="nav-icon">‚öôÔ∏è</div><span>Settings</span>
  </button>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TIMER MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="modal-overlay" id="timerModal">
  <div class="modal-sheet">
    <div class="modal-title">‚è± Study Timer</div>
    <div class="timer-mode" id="timerMode">20 min focus session</div>
    <div class="timer-big" id="timerBig">20:00</div>
    <div style="font-size:14px;font-weight:900;margin-bottom:10px;color:var(--warm-brown-light);">Break length:</div>
    <div class="break-options">
      <div class="break-opt active" onclick="selectBreak(5,this)">5 minutes</div>
      <div class="break-opt" onclick="selectBreak(10,this)">10 minutes</div>
    </div>
    <div class="timer-controls">
      <button class="timer-ctrl-btn start" id="timerStartBtn" onclick="startStopTimer()">‚ñ∂ Start</button>
      <button class="timer-ctrl-btn stop" onclick="closeTimer()">Close</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DICTIONARY POPUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="dict-popup" id="dictPopup">
  <button class="dict-close" onclick="closeDict()">√ó</button>
  <div class="dict-word" id="dictWord"></div>
  <div class="dict-pron" id="dictPron"></div>
  <div class="dict-def" id="dictDef"></div>
  <button class="dict-speak" onclick="speakWord()">üîä Hear it</button>
</div>

<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
const scriptData = [
  { char: 'FAIRY', text: 'How now, spirit! Whither wander you?', mine: false },
  { char: 'PUCK', text: 'Over hill, over dale, thorough bush, thorough brier, over park, over pale, thorough flood, thorough fire.', mine: true },
  { char: 'FAIRY', text: 'Either I mistake your shape and making quite, or else you are that shrewd and knavish sprite called Robin Goodfellow.', mine: false },
  { char: 'PUCK', text: 'Thou speak\'st aright; I am that merry wanderer of the night.', mine: true },
  { char: 'FAIRY', text: 'The king doth keep his revels here tonight.', mine: false },
  { char: 'PUCK', text: 'I must go seek some dewdrops here and hang a pearl in every cowslip\'s ear.', mine: true },
];

const cueLines = [
  { cue: 'How now, spirit! Whither wander you?', myLine: 'Over hill, over dale, thorough bush, thorough brier, over park, over pale, thorough flood, thorough fire.' },
  { cue: 'Either I mistake your shape and making quite, or else you are that shrewd and knavish sprite called Robin Goodfellow.', myLine: "Thou speak'st aright; I am that merry wanderer of the night." },
  { cue: 'The king doth keep his revels here tonight.', myLine: "I must go seek some dewdrops here and hang a pearl in every cowslip's ear." },
  { cue: 'Farewell, thou lob of spirits; I\'ll be gone.', myLine: "Our queen and all our elves come here anon." },
  { cue: 'The queen of fairies wants a changeling child.', myLine: "And jealous Oberon would have the child knight of his train." },
  { cue: 'How long within this wood intend you stay?', myLine: "Perchance till after Theseus' wedding-day." },
];

const gameLines = [
  { line: "I am that merry wanderer of the night.", blank: "merry", options: ["merry","noble","sleepy","dark"] },
  { line: "Lord, what fools these mortals be!", blank: "fools", options: ["fools","knaves","souls","men"] },
  { line: "The course of true love never did run smooth.", blank: "smooth", options: ["smooth","clear","fast","true"] },
  { line: "I must go seek some dewdrops here.", blank: "dewdrops", options: ["dewdrops","moonbeams","starlight","raindrops"] },
  { line: "How now, spirit! Whither wander you?", blank: "wander", options: ["wander","travel","roam","stray"] },
];

const dictionary = {
  'whither': { pron: '/Ààw…™√∞…ôr/', def: 'To what place or state; where are you going?' },
  'dale': { pron: '/de…™l/', def: 'A broad, open valley, especially in northern England.' },
  'brier': { pron: '/Ààbra…™…ôr/', def: 'A prickly shrub, especially the wild rose or similar plant.' },
  'knavish': { pron: '/Ààne…™v…™ É/', def: 'Dishonest or unscrupulous; mischievously rogue-like.' },
  'sprite': { pron: '/spra…™t/', def: 'A fairy or elf; a lively, quick person.' },
  'cowslip': { pron: '/Ààka äsl…™p/', def: 'A yellow wildflower common in meadows across Europe.' },
  'wanderer': { pron: '/Ààw…índ…ôr…ôr/', def: 'A person who roams freely with no fixed destination.' },
  'revels': { pron: '/Ààr…õv…ôlz/', def: 'Lively and noisy celebrations or festivities.' },
  'mortals': { pron: '/Ààm…îÀêt…ôlz/', def: 'Human beings, as opposed to gods or supernatural beings.' },
  'course': { pron: '/k…îÀês/', def: 'The route or direction in which something proceeds.' },
};

// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let currentCue = 0;
let lineRevealed = false;
let timerInterval = null;
let timerSeconds = 1200;
let timerRunning = false;
let breakLength = 5;
let isBreak = false;
let currentGameQ = 0;
let gameScore = 0;
let gameStreak = 0;
let gameTimerSecs = 60;
let gameTimerInterval = null;
let fontSizeVal = 16;

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function goTo(screenId) {
  document.querySelectorAll('.screen,.game-screen').forEach(s => s.classList.remove('active'));
  document.getElementById(screenId).classList.add('active');
  window.scrollTo(0,0);
}

function navTo(screenId, btn) {
  goTo(screenId);
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  btn.classList.add('active');
}

function goToScript() { navTo('scriptScreen', document.querySelectorAll('.nav-item')[1]); loadScript(); }

// ‚îÄ‚îÄ SCRIPT ‚îÄ‚îÄ
function loadScript() {
  const view = document.getElementById('scriptReadView');
  const content = document.getElementById('scriptContent');
  view.style.display = 'block';
  const charName = document.getElementById('charName').value.toUpperCase() || 'PUCK';
  content.innerHTML = scriptData.map(line => `
    <div class="script-line">
      <div class="char-name">${line.char}</div>
      <div class="${line.mine ? 'my-line' : 'other-line'}">
        ${line.text.split(' ').map(w => `<span class="word" onclick="lookupWord('${w.replace(/[^a-zA-Z]/g,'').toLowerCase()}')">${w} </span>`).join('')}
      </div>
    </div>
  `).join('');
  showToast('Script loaded! Tap any word for its definition üìñ');
}

// ‚îÄ‚îÄ DICTIONARY ‚îÄ‚îÄ
function lookupWord(word) {
  const clean = word.toLowerCase().replace(/[^a-z]/g,'');
  const popup = document.getElementById('dictPopup');
  const entry = dictionary[clean];
  document.getElementById('dictWord').textContent = clean;
  document.getElementById('dictPron').textContent = entry ? entry.pron : '/Ààw…úÀêrd/';
  document.getElementById('dictDef').textContent = entry ? entry.def : 'A common English word. Click "Hear it" to hear pronunciation.';
  popup.classList.add('show');
}

function closeDict() { document.getElementById('dictPopup').classList.remove('show'); }

function speakWord() {
  const word = document.getElementById('dictWord').textContent;
  if ('speechSynthesis' in window) {
    const u = new SpeechSynthesisUtterance(word);
    u.rate = 0.8;
    speechSynthesis.speak(u);
  }
  showToast('üîä Speaking: ' + word);
}

// ‚îÄ‚îÄ CUE CARDS ‚îÄ‚îÄ
function startCueCards() {
  currentCue = 0;
  loadCue();
  goTo('cueScreen');
}

function loadCue() {
  const data = cueLines[currentCue];
  const pct = (currentCue / cueLines.length) * 100;
  document.getElementById('cueProgress').style.width = pct + '%';
  document.getElementById('cueProgressLabel').textContent = `Line ${currentCue+1} of ${cueLines.length}`;
  document.getElementById('cueText').textContent = data.cue;
  document.getElementById('myLineText').textContent = data.myLine;
  document.getElementById('myLineText').style.display = 'none';
  document.getElementById('myLinePlaceholder').style.display = 'block';
  document.getElementById('myLineBox').classList.remove('revealed');
  document.getElementById('feedbackRow').style.display = 'none';
  document.getElementById('nextBtn').classList.remove('show');
  document.getElementById('resultBanner').className = 'result-banner';
  document.getElementById('voiceBtn').className = 'voice-btn';
  document.getElementById('voiceBtn').textContent = 'üéô Speak Your Line';
  lineRevealed = false;
}

function revealLine() {
  if (!lineRevealed) {
    lineRevealed = true;
    document.getElementById('myLinePlaceholder').style.display = 'none';
    document.getElementById('myLineText').style.display = 'block';
    document.getElementById('myLineBox').classList.add('revealed');
    document.getElementById('feedbackRow').style.display = 'flex';
  }
}

let voiceListening = false;
function toggleVoice() {
  if (!voiceListening) {
    voiceListening = true;
    const btn = document.getElementById('voiceBtn');
    btn.classList.add('listening');
    btn.textContent = 'üî¥ Listening... (tap to stop)';
    setTimeout(() => {
      voiceListening = false;
      btn.classList.remove('listening');
      btn.textContent = 'üéô Speak Your Line';
      simulateVoiceCheck();
    }, 2500);
  } else {
    voiceListening = false;
    const btn = document.getElementById('voiceBtn');
    btn.classList.remove('listening');
    btn.textContent = 'üéô Speak Your Line';
  }
}

function simulateVoiceCheck() {
  const outcomes = ['correct','close','wrong'];
  const outcome = outcomes[Math.floor(Math.random()*3)];
  const banner = document.getElementById('resultBanner');
  revealLine();
  if (outcome === 'correct') {
    banner.textContent = '‚úÖ Word perfect! Brilliant! 9/9 words correct.';
    banner.className = 'result-banner correct-result';
    document.getElementById('nextBtn').classList.add('show');
  } else if (outcome === 'close') {
    banner.textContent = 'üü° So close! 7/9 words correct. You said "wanderer" instead of "merry wanderer".';
    banner.className = 'result-banner wrong-result';
    document.getElementById('feedbackRow').style.display = 'flex';
  } else {
    banner.textContent = '‚ùå Not quite. 5/9 words correct. Keep trying ‚Äî you\'ve got this!';
    banner.className = 'result-banner wrong-result';
    document.getElementById('feedbackRow').style.display = 'flex';
  }
}

function nextCue(result) {
  if (result === 'correct') addXP(10);
  currentCue++;
  if (currentCue >= cueLines.length) {
    showToast('üéâ Scene complete! Amazing work!');
    setTimeout(() => goTo('practiceScreen'), 1200);
  } else {
    loadCue();
  }
}

// ‚îÄ‚îÄ GAME ‚îÄ‚îÄ
function startFillBlank() {
  currentGameQ = 0;
  gameScore = 0;
  gameStreak = 0;
  gameTimerSecs = 60;
  goTo('fillBlankGame');
  loadGameQuestion();
  startGameTimer();
}

function loadGameQuestion() {
  const q = gameLines[currentGameQ % gameLines.length];
  const blanked = q.line.replace(q.blank, `<span class="blank" id="blankSpan">_______</span>`);
  document.getElementById('gameLineDisplay').innerHTML = `<div style="color:var(--warm-brown-light);font-size:12px;font-weight:900;margin-bottom:10px;text-transform:uppercase;letter-spacing:1px;">Fill in the missing word:</div>${blanked}`;
  const pct = ((currentGameQ % gameLines.length) / gameLines.length) * 100;
  document.getElementById('gameProgress').style.width = pct + '%';
  const opts = document.getElementById('wordOptions');
  opts.innerHTML = '';
  q.options.sort(() => Math.random()-0.5).forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'word-option';
    btn.textContent = opt;
    btn.onclick = () => checkAnswer(opt, q.blank, btn);
    opts.appendChild(btn);
  });
  document.getElementById('gameResultBanner').className = 'result-banner';
  document.getElementById('gameNextBtn').classList.remove('show');
  updateGameUI();
}

function checkAnswer(chosen, correct, btn) {
  const banner = document.getElementById('gameResultBanner');
  const blank = document.getElementById('blankSpan');
  document.querySelectorAll('.word-option').forEach(b => b.style.pointerEvents = 'none');
  if (chosen === correct) {
    blank.textContent = chosen;
    blank.classList.add('filled');
    gameScore += 50 + (gameStreak * 10);
    gameStreak++;
    banner.textContent = `‚úÖ Correct! +${50 + ((gameStreak-1)*10)} pts${gameStreak > 1 ? ' üî• x'+gameStreak+' streak!' : ''}`;
    banner.className = 'result-banner correct-result';
    if (gameStreak > 2) triggerStreak();
    btn.style.background = 'var(--sage)';
    btn.style.color = 'white';
    btn.style.borderColor = 'var(--sage)';
  } else {
    blank.textContent = chosen;
    blank.classList.add('wrong-ans');
    gameStreak = 0;
    banner.textContent = `‚ùå Not quite! The word was "${correct}". You've got this!`;
    banner.className = 'result-banner wrong-result';
    btn.style.background = 'var(--terracotta)';
    btn.style.color = 'white';
    btn.style.borderColor = 'var(--terracotta)';
  }
  updateGameUI();
  document.getElementById('gameNextBtn').classList.add('show');
}

function nextGameQuestion() {
  currentGameQ++;
  loadGameQuestion();
}

function updateGameUI() {
  document.getElementById('gameScore').textContent = gameScore;
  document.getElementById('gameStreak').textContent = gameStreak;
}

function startGameTimer() {
  clearInterval(gameTimerInterval);
  gameTimerSecs = 60;
  gameTimerInterval = setInterval(() => {
    gameTimerSecs--;
    document.getElementById('gameTimer').textContent = gameTimerSecs;
    if (gameTimerSecs <= 0) {
      clearInterval(gameTimerInterval);
      showToast(`‚è± Time's up! Final score: ${gameScore} pts`);
      setTimeout(() => goTo('gameScreen'), 1500);
    }
  }, 1000);
}

function triggerStreak() {
  const el = document.getElementById('streakAnim');
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 800);
}

function changeDiff(val) {
  const times = { easy: 90, medium: 60, hard: 30 };
  gameTimerSecs = times[val];
  clearInterval(gameTimerInterval);
  startGameTimer();
  showToast(`Difficulty: ${val.charAt(0).toUpperCase()+val.slice(1)} ‚Äî ${times[val]}s per round`);
}

// ‚îÄ‚îÄ TIMER ‚îÄ‚îÄ
function showTimer() {
  document.getElementById('timerModal').classList.add('show');
}
function closeTimer() {
  document.getElementById('timerModal').classList.remove('show');
  clearInterval(timerInterval);
  timerRunning = false;
  timerSeconds = 1200;
  isBreak = false;
  document.getElementById('timerBig').textContent = '20:00';
  document.getElementById('timerStartBtn').textContent = '‚ñ∂ Start';
  document.getElementById('timerMode').textContent = '20 min focus session';
}

function selectBreak(mins, el) {
  breakLength = mins;
  document.querySelectorAll('.break-opt').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}

function startStopTimer() {
  if (!timerRunning) {
    timerRunning = true;
    document.getElementById('timerStartBtn').textContent = '‚è∏ Pause';
    timerInterval = setInterval(tickTimer, 1000);
  } else {
    timerRunning = false;
    clearInterval(timerInterval);
    document.getElementById('timerStartBtn').textContent = '‚ñ∂ Resume';
  }
}

function tickTimer() {
  timerSeconds--;
  if (timerSeconds < 0) {
    if (!isBreak) {
      isBreak = true;
      timerSeconds = breakLength * 60;
      document.getElementById('timerMode').textContent = `${breakLength} min break üåø`;
      document.getElementById('timerBig').style.color = 'var(--sage)';
      showToast('üåø Break time! Well done!');
    } else {
      isBreak = false;
      timerSeconds = 1200;
      document.getElementById('timerMode').textContent = '20 min focus session';
      document.getElementById('timerBig').style.color = 'var(--terracotta)';
      showToast('‚è± Back to studying! You\'ve got this!');
    }
  }
  const m = Math.floor(timerSeconds/60);
  const s = timerSeconds%60;
  document.getElementById('timerBig').textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

// ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ
function toggleSetting(btn) { btn.classList.toggle('active'); }

function changeFontSize(delta) {
  fontSizeVal = Math.max(12, Math.min(24, fontSizeVal + delta));
  document.getElementById('fontSizeVal').textContent = fontSizeVal;
  document.querySelectorAll('.script-view').forEach(v => v.style.fontSize = fontSizeVal+'px');
}

function setTheme(color, el) {
  document.documentElement.style.setProperty('--sand', color);
  document.querySelectorAll('.swatch').forEach(s => s.classList.remove('active'));
  el.classList.add('active');
}

function setBreak(mins, btn) {
  breakLength = mins;
  document.querySelectorAll('.break-opt').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  showToast(`Break length set to ${mins} minutes`);
}

function switchScripts(btn, type) {
  document.querySelectorAll('.setting-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  showToast(type === 'mine' ? 'üìö Using your scripts' : 'üìñ Using sample scripts');
}

// ‚îÄ‚îÄ XP / TOAST ‚îÄ‚îÄ
function addXP(pts) {
  showToast(`+${pts} XP earned! ‚≠ê`);
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
document.addEventListener('click', function(e) {
  if (!e.target.closest('#dictPopup') && !e.target.closest('.word')) {
    document.getElementById('dictPopup').classList.remove('show');
  }
});
</script>
</body>
</html>
